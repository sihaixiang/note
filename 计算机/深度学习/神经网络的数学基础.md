### 张量

张量是矩阵向任意维度的推广（张量的维度叫做轴）、

#### 标量（0D张量）

```python
import numpy as np
x = np.array(12)
x
#array(12)
x.ndim     #ndim轴
#0    
```

#### 向量（1D张量）

数字组成的数组叫做向量或一维张量（1D张量）。只有一个轴

```python
import numpy as np
x = np.array([12,2,5,5,8])
x
#array([12,2,5,5,8])
x.ndim
#1
```

#### 矩阵（2D张量）

```python
import numpy as np
x = np.array([[1,2,3,4],
             [5,6,7,8],
             [9,8,7,4]])
x
#array([[1,2,3,4],[5,6,7,8],[9,8,7,4]])
x.ndim
#2
```

### 关键属性

- 轴的个数

  ndim

- 形状

  shape

- 数据类型

  dtype

### 显示第n个数字

```python
#采用matplotlib库
digit = train_images[4]  
import matplotlib.pyplot as plt
plt.imshow(digit, cmap = plt.binary)
plt.show()
```

### 现实中的张量

- 向量数据：2D张量，形状为（samples，features）
  - 人口统计数据集
  - 文本文档数据集
- 时间序列数据：3D张量，形状为（samples，timesteps，features）
  - 股票价格数据集
  - 推文数据集
- 图像：4D张量，形状为（samples，height，width，channels）或（samples，channels，height，width）
- 视频：5D张量，形状为（samples，frames，height，width，channels）或（samples，frames，channels，height，width）

### 张量的运算

#### 逐元素运算

relu运算和加法都是逐元素运算，独立的运用张量的每个元素

```python
def native_relu(x):
    assert len(x.shape) == 2   #x是一个numpy的2D张量
    
    x = x.copy()              #避免覆盖输入张量
    for i in range(x.shape[0]):
        for j in range(x.shape[1]):
            x[i,j] = max(x[i,j], 0)
    return x
```

```python
def native_add(x, y):             #仅支持两个形状相同的2D张量相加
    assert len(x.shape) == 2
    assert x.shape == y.shape
    
    x = x.copy()
    for i in range(x.shape[0]):
        for j in range(x.shape[1]):
            x[i, j] +=y[i, j]
    return x
```

#### 广播

- 向较小的张量添加轴（广播轴），使其ndim与较大的张量相同
- 将较小的张量沿着新轴重复，使其形状与较大的张量相同

```python
def native_add_matrix_and_vector(x,y):
    assert len(x.shape) == 2
    assert len(y.shape) == 1
    assert x.shape[1] == y.shape[0]
    
    x = x.copy()
    for i in range(x.shape[0]):
        for j in rang(y.shape[1]):
            x[i,j] +=y[j]
    return 0
```

```python
import numpy as np
x = np.random.random((64,3,32,10))
y = np.random.random((32,10))
z = np.maximum(x,y)
print(z.shape)     #(64, 3, 32, 10)
```

#### 张量点积

点积运算，也叫作张量积，它将输入张量的元素合并在一起。

采用dot运算来实现点积

```python
import numpy as np
z = np.dot(x,y)
#数学符号中的点（·）表示点积运算
# z= x·y
```

```python
#元素个数相同的向量
def native_vector_dot(x,y):
    assert len(x.shape) == 1
    assert len(y.shape) == 1
    assert x.shape[0] == y.shape[0]
    
    z = 0.
    for i in range(x.shape[0]):
        z += x[i]*y[i]
    return z
```

```python
#矩阵x与向量y
import numpy as np

def native_matrix_vector_dot(x,y):
    assert len(x.shape) == 2
    assert len(y.shape) == 1    
    assert x.shape[1] == y.shape[0]
    
    z = np.zeros(x.shape[0])
    for i in range(x.shape[0]):
        for j in range(x.shape[1]):
            z[i] += x[i,j]*y[j]
    return z

#复用前文的代码
def native_matrix_vector_dot(x,y):
    z = np.zeros(x.shape[0])
    for i in range(x.shape[0]):
        z[i] = native_vector_dot(x[i,:],y)
    return z
```

